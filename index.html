<!DOCTYPE html>
<html>

<head>
    <title>We give loan</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <script src="" type="text/javascritpt"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/calculator.css">


</head>

<body>
    <div class="container fluid">
        <header style="margin-bottom:-400px;">
            <div class="header_bg"></div>
            <div class="header_bg1"></div>
            <h1>We give loan</h1>

            <div>
                <nav style="color:white;">
                    navigator//nav//nav//
                </nav>
            </div>
            <section class="hero text-light text-center">
                <div class="container-sm">
                    <div class="hero-inner">
                        <!-- <h2 class="hero-title h2-mobile mt-0 is-revealing">Landing template for startups</h1> -->
                        <p class="hero-paragraph is-revealing">Our Calculation is accurate, with one analysis we can
                            process
                            several banks to be paid to you.</p>
                        <p class="hero-cta is-revealing"><a class="button button-secondary button-shadow" href="#loan-space">Get
                                started now</a></p>
                        <div class="hero-media">
                        </div>
                    </div>
                </div>
            </section>
        </header>
        <div class="row">
            <svg width="132" height="40" xmlns="http://www.w3.org/2000/svg">
            </svg>
        </div>
        <section id="loan-space"></section>
        <div class="row" style="margin:15px;">
            <div class="col col-6 d-flex form card-shadow">
                <form id="loan_form" class="p-5" name="loan_form">
                    <!-- start of first tab -->
                    <div class="tab">
                        <div class="form-group">
                            <div>
                                <label class=" form-header">Repayment Calculator</label>
                            </div>
                            <label class=" form-header">
                                You have to pay: <b><span id="result"></span></b>
                            </label>
                        </div>
                        <div class="form-group row">
                            <label for="email_address">Email</label>
                            <input type="text" class="form-control" id="email_address" name="email_address" value=""
                                placeholder="john@example.com" required>
                            <label name="validate_label"></label>
                        </div>
                        <div class="form-group row">
                            <label for="amount_range"> Choose Loan Amount:</label>

                            <input type="range" min="300" max="6000" step="300" value="300" class="slider" id="amount_range"
                                name="loan_amount">
                            <span id="amount_value" style="color:darkred; font-size:25px;"></span>
                        </div>

                        <div class="form-group row">
                            <label for="installment_range"> Installment:</label> *
                            <input type="range" min="1" max="60" value="2" class="slider" id="installment_range" name="installment_range">
                            <span id="installment_value" style="color:darkred; font-size:25px;"></span>
                        </div>

                        <div class="form-group row">
                            <label for="installments">Min Installment Amount</label>
                            <input type="text" class="form-control" id="min_installment" value="" placeholder="Min Installments"
                                required name="min_installment">
                        </div>

                        <div class="form-group row">
                            <label class="form-check-label" for="employment_status" name="employment_satus"> Employed?
                                [yes
                                to check]
                                <input class="form-check-input" type="checkbox" value="employment" id="employment_status"
                                    name="employment_status">
                        </div>
                    </div>
                    <!-- end of first tab -->
                    <!-- start of second tab -->
                    <div class="tab">

                        <div class="form-group row">
                            <label for="f_name">Name</label>
                            <input type="text" class="form-control" id="f_name" value="" placeholder="First Name" name="f_name">
                        </div>

                        <div class="form-group row">
                            <label for="l_name">Last Name</label>
                            <input type="text" class="form-control" id="l_name" value="" placeholder="Last Name" name="l_name">
                        </div>

                        <div class="form-group row">
                            <label for="address">Address </label>
                            <input type="text" class="form-control" id="address" value="" placeholder="Your Address here"
                                name="address">
                        </div>
                    </div>
                    <!-- end tab -->

                    <button id="previous_button" type="button" onclick="previousPage()" class="btn btn-info btn-info mb-2">
                        << Previous </button> <button id="next_button" type="button" onclick="nextPage()" class="btn btn-info btn-info mb-2">
                            Next>>
                    </button>


                    <div style="text-align:center;margin-top:40px;">
                        <span class="step"></span>
                        <span class="step"></span>
                        <span class="step"></span>
                        <span class="step"></span>
                    </div>

                </form>
            </div>
            <div class="col col-6 d-flex ">
                <section id="About-us" style="text-align:end;">
                    <aside>
                        <h1>How we operate</h1>
                        <p>
                            How we operate in the loan sector is this a
                            proper way to identify
                        </p>
                    </aside>

                </section>
            </div>
        </div>

        <div class="row">
            <div class="col col-6 d-flex ">
                <aside>
                    <h1>About !</h1>
                    <p>We provide our customer evalution if they are elligible for loan or not .</p>
                </aside>
                <div>
                    <form>
                        <input required>
                        <input required>
                        <button>Submit</button>
                    </form>
                </div>
            </div>
            <div class="col col-4">
                <div class="card text-white bg-info card-shadow" style="width: 25em;">
                    <div class="card-header"><span style="font-size:3em;">!</span></div>
                    <div class="card-body ">
                        <h5 class="card-title">What Is an Amortized Loan?</h5>
                        <p class="card-text">
                            An amortized loan is a loan with scheduled periodic
                            payments that are applied to both principal and interest.
                        </p>
                        <p class="card-text">
                            An amortized loan payment first pays off the relevant interest expense for the
                            period, after which the remainder of
                            the payment reduces the principal. Common amortized loans include auto loans,
                            home loans and personal loans from a bank for small projects or debt consolidation.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <p>Copyright 2019 we goive loan</p>
        </footer>
    </div>


    <!-- <script src="./src/main.js" type="text/javascript"> -->
    <script>
    
        // variables Global
        const state = {
            next_button: 1,
            previous_button: 0,
            current_tab: 0,
        }
        var loanForm = document.loan_form;
        init()
        var loanSlider = document.getElementById('amount_range');
        var amountValue = document.getElementById('amount_value');
        // default value on load
        amountValue.innerHTML = loanSlider.value;

        var installmentSlider = document.getElementById("installment_range");
        var installmentValue = document.getElementById("installment_value");
        // Display the default slider value onload
        installmentValue.innerHTML = installmentSlider.value;

        loanSlider.oninput = function () {
            amountValue.innerHTML = this.value;
            calculateLoan();
        }

        // Update the current slider value (each time you drag the slider handle)
        installmentSlider.oninput = function () {
            installmentValue.innerHTML = this.value;
            calculateLoan()
        }

        function sendMail(formData) {

            //TODO: this should be implemented soon
            // customer email sendin implementation from server-side 
        }            console.log(loanForm)

        var installmentMinAmount = loanForm.min_installment;

        function ifEmployd(checkbox) {
            if (checkbox == true) return 1;
            else return 0;
        }

        function formFieldCheck(form = {}) {

            var email = form.email_address.value;//check email regex
            var min_installment_amount = form.valueOf().min_installment.value;
            const employmentStatus = ifEmployd(form.employment_status.checked); // if checked 1 else 0
            console.log(form.employment_status.checked)
            if (!email || !min_installment_amount) {
                // form.validate_input.nextSibling.innerHTML="must";
                console.log(form)
                form.email_address.placeholder = "Required field";
                form.min_installment.placeholder = "Required field"
                return 0;
            }
            state.next_button = true;
            console.log(email, min_installment_amount, state.next_button)
        }

        function calculateLoan() {
            // INFO :: if this checks ok
            // const check = formFieldCheck(document.loan_form);
            const INTEREST_RATE = (6 / 100) / 12;
            var loan_amount = loanSlider.value || "provide value";
            var installment_min = installmentMinAmount.value || 50;
            var repay_duration = installmentSlider.value || "provide value";
            var form = document.getElementById('loan-form');

            /**
             * Loan Payment = Amount / Discount Factor or P = A / D
             * Discount Factor (D) = {[(1 + i) ^n] - 1} / [i(1 + i)^n] 
            */
            var discount_factor =
                (Math.pow((1 + INTEREST_RATE), repay_duration) - 1) /
                (INTEREST_RATE * Math.pow((1 + INTEREST_RATE), repay_duration));
            var repay = Math.round(loan_amount / discount_factor) || "Please fill all the amount";
            document.getElementById("result").innerHTML = repay + "€/Month";
        }

        /*
        form View satrt
        */
        function nextPage() {
            // const check = formFieldCheck(document.loan_form);
            increament();
            console.log(state.current_tab)
            formPageView(state.current_tab)
        }

        function previousPage() {
            decrement();
            console.log(state.current_tab)
            formPageView(state.current_tab)
        }

        function increament() {
            state.current_tab = state.current_tab + 1;
            return true;
        }

        function decrement() {
            state.current_tab = state.current_tab - 1;
            return true;
        }

        function formPageView(index) {
            var tabs = document.getElementsByClassName('tab');
            // console.log(document.loan_form);
            // return ; 
            tabs[index].style.display = "block";

            if (index == 0) {
                document.loan_form.previous_button.style.display = "none";
            } else {
                document.loan_form.previous_button.style.display = "inline";
            }
            if (index==tabs.length-1){
                document.loan_form.next_button.innerHTML="Submint";
            }else{
                document.loan_form.next_button.innerHTML="Next >>"
            }



        }

        function init() {
            formPageView(state.current_tab)
            console.log('===>',state.current_tab)

        }
        /*form view end*/
    </script>
</body>

</html>